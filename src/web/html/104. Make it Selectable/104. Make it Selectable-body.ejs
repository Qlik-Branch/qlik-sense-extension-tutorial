<div id="section-0"class="section "><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>We’ve now got an extension that renders data from Qlik. That is only one piece of the puzzle however. It’s unidirectional: we receive data from Qlik that we render. But we also want our extension to be able to go the opposite direction. That is to say, we want to be able to filter data in Qlik by interacting with our extension. Let’s work on this feature next.</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph"></div></div></div></div><div id="section-1"class="section field-indices"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>In the previous chapter, we did a deep-dive on the qMatrix structure that contains our calculated data in HyperCubes. Specifically, we looked at the individual cells in our row and column structure and examined properties like qNum and qText. One special property we discussed was the qElemNumber. When looking at a dimension cell, the qElemNumber represents the Field Index of a dimension value within a dimension. The Field Index is Qlik’s unique identifier for a distinct value in a Field. This index is important to us because it can be used to tell Qlik exactly which values we want to filter in a dimension.</br></br></br>In order to leverage our qElemNumbers to make selections, we need an API to talk to Qlik. Enter the <strong>Backend API</strong>.</br></br></br></p><h3>The Backend API</h3><p>The BackendAPI is an API unique to extensions that enables us to communicate with the Qlik engine. It provides some Helper functions for common calls that we might want to make in our extension. For example, the Backend API has a getProperties method that will retrieve our Generic Object properties. <a href="http://help.qlik.com/en-US/sense-developer/3.2/Subsystems/APIs/Content/backend-api-reference.htm">For more on the Backend API, check out the documentation.</a></br></br></br>One key function in the Backend API is the selectValues method. This method can filter data in a dimension that exists in our HyperCube. It takes 3 inputs:</p><ol><li><p>A number for the index of our dimension. The first dimension in our HyperCube would be index 0.</p></li><li><p>An array of qElemNumbers to select. All values entered here will be part of the new selection.</p></li><li><p>A boolean for the toggle mode of our selection. When true, the selected values will be added to any already selected values. When false, any already selected values will be discarded before selecting the new list of values.</p></li></ol></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="field-indices"><img src="./imgs/field-indices.png" alt="" class="img-responsive field-indices"></img></div></div></div></div><div id="section-2"class="section hypercube-table-annotated"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>Let’s take the following example table from a HyperCube, with annotated Field Indices:</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="hypercube-table-annotated"><img src="./imgs/hypercube-table-annotated.png" alt="" class="img-responsive hypercube-table-annotated"></img></div></div></div></div><div id="section-3"class="section select-values-editor"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>Let’s say I want to select "Manufacturing" and "Contractor" from my "Department" dimension. Since that dimension is in the first column, I could use the method <code>selectValues(0, [0, 1], false)</code></p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="select-values-editor"></div></div></div></div><div id="section-4"class="section pre-selection"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>pre-selection</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="pre-selection"><img src="./imgs/pre-selection.png" alt="" class="img-responsive pre-selection"></img></div></div></div></div><div id="section-5"class="section post-selection"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>post-selection</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="post-selection"><img src="./imgs/post-selection.png" alt="" class="img-responsive post-selection"></img></div></div></div></div><div id="section-6"class="section "><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>This call ensures that I filter to only the field values with indices 0 and 1.</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph"></div></div></div></div><div id="section-7"class="section select-values-editor-2"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>If I want to add more selections on top, I could make the call again and set the toggle mode to true: <code>selectValues(0, [4], true)</code></p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="select-values-editor-2"><img src="./imgs/toggle-mode-true.png" alt="" class="img-responsive toggle-mode-true"></img></div></div></div></div><div id="section-8"class="section select-values-editor-3"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>Alternatively, I could have set toggle mode to false, which would deselect elements 1 and 3 and then select element 4: <code>selectValues(0, [4], false)</code></p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="select-values-editor-3"><img src="./imgs/toggle-mode-false.png" alt="" class="img-responsive toggle-mode-false"></img></div></div></div></div><div id="section-9"class="section "><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <h3>Adding Selections to Our Table</h3><p>Now that we know how to use the selectValues method, we can incorporate it into our extension. Let’s add a feature where a user can click on a dimension value to filter to that dimension.</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph"></div></div></div></div><div id="section-10"class="section paint-editor"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>First, we are going to need to access the Backend API in our extension code. In our paint method, we can access the Backend API via this.backendApi. Let’s go ahead and save off that reference for later use:</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="paint-editor"></div></div></div></div><div id="section-11"class="section paint-editor-2"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>In order to make our cells selectable, we need to tag them with the right metadata that we can use to feed a selectValues call. Let’s start by editing our code where we create table cells to determine if they are dimension cells or not. We can do this by comparing the column number to our dimensionInfo array length.</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="paint-editor-2"></div></div></div></div><div id="section-12"class="section paint-editor-3"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>Inside of our new if statement, we can add the metadata we want to the table cell. For our purposes, let’s tag it with a class called selectable that we can use to find the selectable cells later. Let’s also add attributes for the dimension column number and the field index.</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="paint-editor-3"></div></div></div></div><div id="section-13"class="section paint-editor-4"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>Almost there! We now have td’s that should be selectable, easily identified by a .selectable class. We also have metadata about the dimension column and the value’s Field Index. Now we just need to create a UI for selection. We can do that by adding a click event to these elements that calls selectValues. Let’s add this at the end after our $element has been populated with the table:</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="paint-editor-4"></div></div></div></div><div id="section-14"class="section extension-selection"><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <p>Now we have an interactive extension that can filter data in our Qlik Sense dashboards!</p></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph" id="extension-selection"><img src="./imgs/extension-selection.gif" alt="" class="img-responsive extension-selection"></img></div></div></div></div><div id="section-15"class="section "><div class="row">
          <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-left">
    <h2>Fin</h2><h4>Recap</h4><ul><li><p>Extensions can interact with the QIX Engine via the Backend API to add functionality like making selections.</p></li></ul><h4>Resources</h4><ul><li><p><a href="http://help.qlik.com/en-US/sense-developer/3.2/Subsystems/APIs/Content/backend-api-reference.htm">Backend API Documentation</a></p></li></ul><h4>Troubleshooting Guide</h4><ul><li></li></ul></div><div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 body-right"><div class="graph"></div></div></div></div>